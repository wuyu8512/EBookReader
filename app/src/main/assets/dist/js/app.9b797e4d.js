(function(t){function e(e){for(var o,r,u=e[0],c=e[1],d=e[2],l=0,f=[];l<u.length;l++)r=u[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);s&&s(e);while(f.length)f.shift()();return i.push.apply(i,d||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,r=1;r<n.length;r++){var u=n[r];0!==a[u]&&(o=!1)}o&&(i.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},r={app:0},a={app:0},i=[];function u(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-2d21a3d2":"89514f8b","chunk-37c86567":"c7209975","chunk-05e3b80e":"a0b183a3","chunk-fa56a4c8":"12b49415"}[t]+".js"}function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-37c86567":1,"chunk-05e3b80e":1,"chunk-fa56a4c8":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise((function(e,n){for(var o="css/"+({}[t]||t)+"."+{"chunk-2d21a3d2":"31d6cfe0","chunk-37c86567":"01ec36f6","chunk-05e3b80e":"5dc3bd50","chunk-fa56a4c8":"600fb402"}[t]+".css",a=c.p+o,i=document.getElementsByTagName("link"),u=0;u<i.length;u++){var d=i[u],l=d.getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(l===o||l===a))return e()}var f=document.getElementsByTagName("style");for(u=0;u<f.length;u++){d=f[u],l=d.getAttribute("data-href");if(l===o||l===a)return e()}var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.onload=e,s.onerror=function(e){var o=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=o,delete r[t],s.parentNode.removeChild(s),n(i)},s.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(s)})).then((function(){r[t]=0})));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var i=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=i);var d,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=u(t);var f=new Error;d=function(e){l.onerror=l.onload=null,clearTimeout(s);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",f.name="ChunkLoadError",f.type=o,f.request=r,n[1](f)}a[t]=void 0}};var s=setTimeout((function(){d({type:"timeout",target:l})}),12e4);l.onerror=l.onload=d,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t};var d=window["webpackJsonp"]=window["webpackJsonp"]||[],l=d.push.bind(d);d.push=e,d=d.slice();for(var f=0;f<d.length;f++)e(d[f]);var s=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"402c":function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var o=n("2b0e"),r=n("f309"),a=n("0fd9"),i=n("94ed");o["a"].use(r["a"],{components:{VRow:a["a"]}}),e["a"]=new r["a"]({});var u={mdiArrowLeft:i["a"],mdiMagnify:i["e"],mdiFormatSize:i["d"],mdiFormatListBulleted:i["c"],mdiWhiteBalanceSunny:i["f"],mdiDotsVertical:i["b"]}},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("router-view")],1)},a=[],i=(n("5c0b"),n("2877")),u=n("6544"),c=n.n(u),d=n("7496"),l={},f=Object(i["a"])(l,r,a,!1,null,null,null),s=f.exports;c()(f,{VApp:d["a"]});var p=n("402c"),g=(n("d3b7"),n("8c4f"));o["a"].use(g["a"]);var h=[{path:"/read/:uri?/:name?",name:"Read",component:function(){return Promise.all([n.e("chunk-37c86567"),n.e("chunk-05e3b80e")]).then(n.bind(null,"c844"))},props:!0},{path:"/",name:"Home",redirect:"/bookshelf",component:function(){return n.e("chunk-2d21a3d2").then(n.bind(null,"bb51"))},children:[{path:"bookshelf/:gid?",name:"Bookshelf",component:function(){return Promise.all([n.e("chunk-37c86567"),n.e("chunk-fa56a4c8")]).then(n.bind(null,"2427"))},props:!0,meta:{keepAlive:!0}}]}],v=new g["a"]({routes:h,scrollBehavior:function(t,e,n){return n||{x:0,y:0}}}),b=v,m=n("2f62"),k=(n("c740"),n("c975"),n("ac1f"),n("1276"),n("3835")),y=n("ae39"),S=n("8f8f"),w={state:{book:null,bookName:null,cover:null,navigation:null,metadata:null,bookAvailable:!1,readProgress:0,section:1,menuShow:!1,fontSettingShow:!1,sidebarShow:!1,fontSize:16},getters:{readSection:function(t){var e,n;return t.navigation?null===(e=t.navigation[t.section-1])||void 0===e?void 0:e.label:null===(n=t.metadata)||void 0===n?void 0:n.title},section:function(t){return t.section},fontSize:function(t){return t.fontSize},fontSettingShow:function(t){return t.fontSettingShow},book:function(t){return t.book},menuShow:function(t){return t.menuShow},sidebarShow:function(t){return t.sidebarShow},bookAvailable:function(t){return t.bookAvailable},navigation:function(t){return t.navigation}},mutations:{updateBookName:function(t,e){t.bookName=e},updateFontSize:function(t,e){t.fontSize=e},updateFontSettingShow:function(t,e){t.fontSettingShow=e},updateBook:function(t,e){t.book=e},updateCover:function(t,e){t.cover=e},updateNavigation:function(t,e){t.navigation=e},updateMetadata:function(t,e){t.metadata=e},updateBookAvailable:function(t,e){t.bookAvailable=e},updateReadProgress:function(t,e){t.readProgress=e},updateSection:function(t,e){t.section=e},updateMenuShow:function(t,e){t.menuShow=e},updateSidebarShow:function(t,e){t.sidebarShow=e}},actions:{refreshLocation:function(t,e){var n=t.commit,o=t.state,r=Object(k["a"])(e,3),a=r[0],i=r[1],u=r[2],c=void 0===u||u,d=o.book.rendition.currentLocation();if(console.log(d),d&&d.start){var l=d.start.cfi;if(c&&Object(y["g"])(o.bookName,l),o.bookAvailable){if(a)for(var f=new S["a"](d.end.cfi),s=0,p=!0,g=function(t){var e=o.navigation[t],r=e.href;if(-1!==r.indexOf("#")&&(r=r.split("#")[0]),e.cfi)s=f.compare(e.cfi,f);else{var a=o.book.spine.spineItems.findIndex((function(t){return t.href===r}));s=a>f.spinePos?1:-1}if(p){if(p=!1,1===s)return n("updateSection",0),"break"}else if(t===o.navigation.length-1&&n("updateSection",t+1),1===s)return n("updateSection",t),"break"},h=0;h<o.navigation.length;++h){var v=g(h);if("break"===v)break}i&&n("updateReadProgress",Math.floor(1e3*d.start.percentage))}}},display:function(t,e){t.commit;var n=t.state;return n.book.rendition.display(e)},setFontSize:function(t,e){var n=t.commit,o=t.state;o.book.rendition.themes.fontSize(e+"px"),n("updateFontSize",e),Object(y["f"])(e)}},modules:{}},x=(n("99af"),n("4de4"),n("7db0"),n("d81d"),n("5530")),O=n("2909"),B=n("d4ec"),j=n("bee2"),_=function(){function t(){Object(B["a"])(this,t)}return Object(j["a"])(t,null,[{key:"read",value:function(t){try{return JSON.parse(window.localStorage.getItem(t))}catch(e){console.log(e)}return null}},{key:"write",value:function(t,e){try{null==e?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e))}catch(n){console.log(n)}}}]),t}();n("4d63"),n("25f0"),n("5319");function L(t){return(t||"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function A(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(t.getFullYear()).substr(4-RegExp.$1.length)));var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getMilliseconds()};for(var o in n)if(new RegExp("(".concat(o,")")).test(e)){var r="".concat(n[o]),a=r.length;"s+"==o&&a--,e=e.replace(RegExp.$1,1===RegExp.$1.length?r:"00".concat(r).substr(a))}return e}function E(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)}))}var F=n("6821"),M=n.n(F),P="EBookReader_BOOK",R={state:{list:_.read(P)},getters:{localBookExist:function(t,e){return e.allGroup.length>0||e.allList.length>0},BookList:function(t){return t.list},hasGroup:function(t,e){return function(t){return null===t||!!e.allGroup.find((function(e){return e.gid===t}))}},groupTitleExist:function(t,e){return function(t,n){var o=L(t);return 0===o.length||!!e.allGroup.find((function(t){return t.gid!==n&&t.data.title===o}))}},cacheTitleExist:function(t,e){return function(t,n){var o=L(t);return 0===o.length||(!!e.allGroup.find((function(t){return t.gid!==n&&t.data.title===o}))||!!e.BookListCache.find((function(t){return!t.bid&&t.gid!==n&&t.data.title===o})))}},hasBook:function(t,e){return function(t){return!!e.BookList.find((function(e){return e.gid?!!e.data.find((function(e){return e.book_path===t})):e.book_path===t}))}},findBook:function(t,e){return function(t){return e.allList.find((function(e){return e.book_path===t}))}},findGroup:function(t,e){return function(t){return e.BookList.find((function(e){return e.gid===t}))}},mapList:function(t,e){return function(t){return{list:e.allList.filter((function(e){return!!t.find((function(t){var n=t.bid,o=t.gid;return e.bid===n||!n&&e.gid===o}))})),group:e.allGroup.filter((function(e){return!!t.find((function(t){var n=t.bid,o=t.gid;return!n&&e.gid===o}))}))}}}},mutations:{updateBookList:function(t,e){t.list=e||[],_.write(P,t.list)}},actions:{addBookGroup:function(t,e){var n=t.commit,o=t.getters,r=(t.dispatch,e||{}),a=r.title,i=r.idx,u=void 0===i?null:i;if(a=L(a),o.groupTitleExist(a))return!1;var c={gid:E(),last_update_time:A(new Date,"yyyy-MM-dd hh:mm:sss"),idx:u,data:{title:a}},d=[].concat(Object(O["a"])(o.allGroup),[c]);return n("updateBookGroup",d),c},removeBookGroup:function(t,e){var n=t.commit,o=t.getters;t.dispatch;Array.isArray(e)||(e=[e]);var r=o.allGroup.filter((function(t){return!e.find((function(e){return e.gid===t.gid}))}));return n("updateBookGroup",r),!0},updateBookGroup:function(t,e){var n=t.commit,o=t.getters;t.dispatch;Array.isArray(e)||(e=[e]);var r=o.allGroup.map((function(t){var n=e.find((function(e){return e.gid===t.gid}));return n&&!o.groupTitleExist(n.data.title,n.gid)?Object(x["a"])(Object(x["a"])(Object(x["a"])({},t),n),{},{last_update_time:A(new Date,"yyyy-MM-dd hh:mm:sss"),data:Object(x["a"])(Object(x["a"])({},t.data),n.data)}):t}));return n("updateBookGroup",r),!0},addToBook:function(t,e){var n=t.commit,o=t.getters,r=(t.dispatch,[e].concat(Object(O["a"])(o.BookList)));return n("updateBookList",r),!0},removeFromBook:function(t,e){var n=t.commit,o=t.getters;t.dispatch;Array.isArray(e)||(e=[e]);var r=o.allList.filter((function(t){return!e.find((function(e){return e.bid===t.bid}))}));return n("updateBookList",r),!0},updateBook:function(t,e){var n=t.commit,o=t.getters;t.dispatch;Array.isArray(e)||(e=[e]);var r=o.allList.map((function(t){var n=e.find((function(e){return e.bid===t.bid}));return n&&o.hasGroup(n.gid)?Object(x["a"])(Object(x["a"])(Object(x["a"])({},t),{},{last_update_time:A(new Date,"yyyy-MM-dd hh:mm:sss")},n),{},{data:Object(x["a"])(Object(x["a"])({},t.data),n.data)}):t}));return n("updateBookList",r),!0}}};window.addToBook=function(t,e){if(!G.getters.BookList||!G.getters.hasBook(t)){var n=new Date,o={book_title:e,book_path:t,add_time:"".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate()),book_cover:M()(e)};G.getters.BookList?G.dispatch("addToBook",o):G.commit("updateBookList",[o])}},o["a"].use(m["a"]);var G=new m["a"].Store({state:{},mutations:{},actions:{},modules:{read:w,book:R}}),N=n("6944"),T=n.n(N);n("0808");o["a"].config.productionTip=!1,o["a"].use(T.a,{defaultOptions:{navbar:!1}}),new o["a"]({vuetify:p["a"],router:b,store:G,render:function(t){return t(s)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"9c0c":function(t,e,n){},ae39:function(t,e,n){"use strict";n.d(e,"h",(function(){return a})),n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return u})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return p}));n("99af"),n("d81d"),n("2ca0");var o,r=n("2909");function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:160,n=new Date;return function(){var o=this,r=arguments,a=new Date-0;a-n>=e&&(t.apply(o,r),n=a)}}function i(t){var e;return(e=[]).concat.apply(e,Object(r["a"])(t.map((function(t){var e;return(e=[]).concat.apply(e,[t].concat(Object(r["a"])(i(t.subitems))))}))))}function u(t,e){var n=JSON.parse(localStorage.getItem("Reading_Record")||"{}");n[t]||(n[t]={}),n[t].cfi=e,localStorage.setItem("Reading_Record",JSON.stringify(n))}function c(t){var e,n=JSON.parse(localStorage.getItem("Reading_Record")||"{}");return null===(e=n[t])||void 0===e?void 0:e.cfi}function d(){return localStorage.getItem("Reading_FontSize")||16}function l(t){localStorage.setItem("Reading_FontSize",t)}var f=null===(o=window.drive)||void 0===o?void 0:o.getExternalFilesDir("Pictures");function s(t){if(t.startsWith("http"))return t;var e="file://"+f+"/"+t;return"file://"!==window.location.origin&&window.drive?"data:image/jpeg;base64,"+drive.readFile(e):e}function p(t){var e;null===(e=window.drive)||void 0===e||e.loadBook(t["book_title"],t["book_path"])}}});
//# sourceMappingURL=app.9b797e4d.js.map